<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Just a Moment</title>

<meta http-equiv="Cache-Control" content="no-store">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  color:white;
  font-family:system-ui,sans-serif;
}

/* ===== רקע מתחלף – CSS בלבד ===== */
body{
  background-size:cover;
  background-position:center;
  animation:bgSlide 66s infinite;
}

@keyframes bgSlide{
  0%   { background-image:url('./bg1.png'); }
  9%   { background-image:url('./bg2.png'); }
  18%  { background-image:url('./bg3.png'); }
  27%  { background-image:url('./bg4.png'); }
  36%  { background-image:url('./bg5.png'); }
  45%  { background-image:url('./bg6.png'); }
  54%  { background-image:url('./bg7.png'); }
  63%  { background-image:url('./bg8.png'); }
  72%  { background-image:url('./bg9.png'); }
  81%  { background-image:url('./bg10.png'); }
  90%  { background-image:url('./bg11.png'); }
  100% { background-image:url('./bg1.png'); }
}

/* שכבת כהות עדינה בלבד */
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.22);
  z-index:0;
}

/* אפליקציה */
#app{
  position:relative;
  z-index:1;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:24px;
}

.text{font-size:22px;margin-bottom:16px;}
.timer{font-size:44px;margin-bottom:20px;}

.buttons{
  width:100%;
  max-width:420px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

button,a{
  display:block;
  padding:16px;
  font-size:16px;
  border:none;
  border-radius:14px;
  background:#374151;
  color:white;
  text-decoration:none;
  text-align:center;
  cursor:pointer;
}

.primary{background:#2563eb;}
.info{background:#065f46;}

.start-btn{
  width:260px;
  margin-top:20px;
}
</style>
</head>

<body>

<div id="overlay"></div>

<div id="app">
  <div class="text">אם בא לך סיגריה — בוא נשהה רגע.</div>
  <button class="primary start-btn" onclick="start()">התחל</button>
</div>

<audio id="audio" preload="auto">
  <source src="./ambient_brown_ok.wav" type="audio/wav">
</audio>

<script>
/* נטרול Service Worker לדף הזה בלבד */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations()
    .then(r => r.forEach(reg => reg.unregister()));
}

/* טקסטים */
const texts=[
  "אין צורך למהר.",
  "עוד רגע של שקט.",
  "הדחף ידע להירגע.",
  "אפשר פשוט להיות כאן.",
  "זה יעבור גם בלי פעולה."
];
let currentText="";
let remaining=600;
let timer;

const app=document.getElementById("app");
const audio=document.getElementById("audio");

function randomText(){
  let t;
  do{
    t=texts[Math.floor(Math.random()*texts.length)];
  }while(t===currentText);
  currentText=t;
  return t;
}

function start(){
  audio.volume=0.6;
  audio.play().catch(()=>{});

  render(true);
  timer=setInterval(()=>{
    remaining--;
    if(remaining<=0) clearInterval(timer);
    render(false);
  },1000);
}

function render(changeText){
  const m=String(Math.floor(remaining/60)).padStart(2,"0");
  const s=String(remaining%60).padStart(2,"0");
  const txt=changeText?randomText():currentText;

  app.innerHTML=`
    <div class="text">${txt}</div>
    <div class="timer">${m}:${s}</div>

    <div class="buttons">
      <button onclick="render(true)">דלג</button>

      <a class="info"
         href="https://he.wikipedia.org/wiki/הפסקת_עישון"
         target="_blank" rel="noopener">
         עזרה להפסקת עישון
      </a>

      <a
         href="https://www.youtube.com/watch?v=gukm--w36PI"
         target="_blank" rel="noopener">
         וידאו – התמודדות עם דחף
      </a>
    </div>
  `;
}
</script>

</body>
</html>
