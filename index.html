<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Just a Moment</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:black;
  color:white;
  font-family:system-ui,sans-serif;
}

/* ===== רקע ===== */
#bg{
  position:fixed;
  inset:0;
  background-size:cover;
  background-position:center;
  z-index:-2;
}
#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.55);
  z-index:-1;
}

/* ===== אפליקציה ===== */
#app{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:24px;
}

.text{
  font-size:22px;
  margin-bottom:16px;
  line-height:1.5;
}

.timer{
  font-size:44px;
  margin-bottom:20px;
}

.buttons{
  width:100%;
  max-width:420px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:center;
}

/* ===== כפתורים ===== */
button{
  padding:14px 18px;
  font-size:16px;
  border:none;
  border-radius:14px;
  background:#2563eb;
  color:white;
  cursor:pointer;
  min-width:140px;
}
.secondary{background:#374151;}
.info{background:#065f46;}

.start-btn{
  width:260px;
  margin-top:20px;
}
</style>
</head>

<body>

<div id="bg"></div>
<div id="overlay"></div>

<div id="app">
  <div class="text">אם בא לך סיגריה — בוא נשהה רגע.</div>
  <button class="start-btn" onclick="start()">התחל</button>
</div>

<audio id="audio" src="./ambient_brown_ok.wav" loop></audio>

<script>
/* ===== תמונות רקע (נתיב מפורש) ===== */
const images=[
  "./bg1.png","./bg2.png","./bg3.png","./bg4.png","./bg5.png",
  "./bg6.png","./bg7.png","./bg8.png","./bg9.png","./bg10.png","./bg11.png"
];
const bg=document.getElementById("bg");
let imgIndex=0;

function setBg(){
  bg.style.backgroundImage="url('"+images[imgIndex]+"')";
  imgIndex=(imgIndex+1)%images.length;
}
setBg();
setInterval(setBg,12000);

/* ===== אודיו ===== */
const audio=document.getElementById("audio");
audio.volume=0.6;

/* ===== טקסטים ===== */
const texts=[
  "אין צורך למהר.",
  "עוד רגע של שקט.",
  "הדחף ידע להירגע.",
  "אפשר פשוט להיות כאן.",
  "זה יעבור גם בלי פעולה.",
  "Just stay with the moment."
];
let currentText="";

/* ===== טיימר ===== */
let remaining=600;
let timer,textTimer,paused=false;
const app=document.getElementById("app");

function randomText(){
  let t;
  do{
    t=texts[Math.floor(Math.random()*texts.length)];
  }while(t===currentText);
  currentText=t;
  return t;
}

function openLink(url){
  location.href=url;
}

function start(){
  audio.play().catch(()=>{});
  render(true);

  timer=setInterval(()=>{
    if(paused) return;
    remaining--;
    if(remaining<=0){
      clearInterval(timer);
      clearInterval(textTimer);
    }
    render(false);
  },1000);

  textTimer=setInterval(()=>{
    if(!paused) render(true);
  },8000);
}

function render(changeText){
  const m=String(Math.floor(remaining/60)).padStart(2,"0");
  const s=String(remaining%60).padStart(2,"0");
  const txt=changeText?randomText():currentText;

  app.innerHTML=`
    <div class="text">${txt}</div>
    <div class="timer">${m}:${s}</div>

    <div class="buttons">
      <button class="secondary" onclick="render(true)">דלג</button>
      <button class="secondary" onclick="paused=!paused">${paused?"המשך":"השהה"}</button>
      <button class="secondary" onclick="audio.muted=!audio.muted">${audio.muted?"סאונד":"השתק"}</button>
    </div>

    <div class="buttons">
      <button class="info" onclick="openLink('https://he.wikipedia.org/wiki/הפסקת_עישון')">
        עזרה להפסקת עישון
      </button>
      <button class="secondary" onclick="openLink('https://www.youtube.com/watch?v=gnSEv8ZsK0E')">
        מה קורה לדחף? (וידאו קצר)
      </button>
    </div>
  `;
}
</script>

</body>
</html>
