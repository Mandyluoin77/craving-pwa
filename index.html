<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Just a Moment</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  color:white;
  font-family:system-ui,sans-serif;
}

body{
  background:url('./bg1.png') center/cover no-repeat fixed;
}

#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.25);
}

#app{
  position:relative;
  z-index:1;
  min-height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:24px;
  text-align:center;
}

.timer{font-size:48px;margin-bottom:20px;}
.text{font-size:22px;margin-bottom:16px;}

.block{
  width:100%;
  max-width:420px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

button,input{
  padding:16px;
  border-radius:14px;
  border:none;
  font-size:16px;
  text-align:center;
}

button{background:#374151;color:white;}
.primary{background:#2563eb;}
.success{background:#065f46;}

input{background:#1f2933;color:white;}

.result{font-size:20px;margin-top:10px;}
</style>
</head>

<body>

<div id="overlay"></div>

<div id="app">

  <div id="message" class="text">×× ×‘× ×œ×š ×¡×™×’×¨×™×” â€” ×‘×•× × ×©×”×” ×¨×’×¢.</div>
  <div id="timer" class="timer">60:00</div>

  <div class="block">
    <button class="primary" onclick="start()">×”×ª×—×œ</button>
    <button onclick="nextText()">×“×œ×’</button>
  </div>

  <div class="block" style="margin-top:20px">
    <input id="cigsPerDay" type="number" placeholder="×¡×™×’×¨×™×•×ª ×‘×™×•×">
    <input id="packPrice" type="number" placeholder="××—×™×¨ ×—×¤×™×¡×” (â‚ª)">
    <button onclick="calcSavings()">×—×©×‘ ×—×™×¡×›×•×Ÿ</button>
    <div id="calcResult" class="result"></div>
  </div>

  <div class="block" style="margin-top:20px">
    <a class="success" href="https://he.wikipedia.org/wiki/×”×¤×¡×§×ª_×¢×™×©×•×Ÿ" target="_blank">
      ×¢×–×¨×” ×œ×”×¤×¡×§×ª ×¢×™×©×•×Ÿ
    </a>
  </div>

</div>

<audio id="audio">
  <source src="./ambient_brown_ok.wav" type="audio/wav">
</audio>

<script>
const texts=[
  "××™×Ÿ ×¦×•×¨×š ×œ××”×¨.",
  "×¢×•×“ ×¨×’×¢ ×©×œ ×©×§×˜.",
  "×”×“×—×£ ×™×“×¢ ×œ×”×™×¨×’×¢.",
  "××¤×©×¨ ×¤×©×•×˜ ×œ×”×™×•×ª ×›××Ÿ.",
  "×–×” ×™×¢×‘×•×¨ ×’× ×‘×œ×™ ×¤×¢×•×œ×”."
];

let textIndex=0;
let remaining=3600;
let timer=null;
let startTime=null;

const message=document.getElementById("message");
const timerEl=document.getElementById("timer");
const audio=document.getElementById("audio");

function updateTimer(){
  const m=String(Math.floor(remaining/60)).padStart(2,"0");
  const s=String(remaining%60).padStart(2,"0");
  timerEl.innerText=`${m}:${s}`;
}

function start(){
  if(timer) return;
  startTime=Date.now();
  audio.volume=0.6;
  audio.play().catch(()=>{});

  timer=setInterval(()=>{
    remaining--;
    updateTimer();
    if(remaining<=0) clearInterval(timer);
  },1000);
}

function nextText(){
  textIndex=(textIndex+1)%texts.length;
  message.innerText=texts[textIndex];
}

function calcSavings(){
  const cigs=Number(document.getElementById("cigsPerDay").value);
  const price=Number(document.getElementById("packPrice").value);
  const result=document.getElementById("calcResult");

  if(!cigs || !price || !startTime){
    result.innerText="× × ×œ×”×–×™×Ÿ × ×ª×•× ×™× ×•×œ×”×ª×—×™×œ.";
    return;
  }

  const minutes=(Date.now()-startTime)/60000;
  const avoided=Math.floor(minutes*(cigs/1440));
  const saved=(avoided*(price/20)).toFixed(2);

  result.innerText=`ğŸš­ ${avoided} ×¡×™×’×¨×™×•×ª | ğŸ’° â‚ª${saved} × ×—×¡×›×•`;
}

updateTimer();
</script>

</body>
</html>
