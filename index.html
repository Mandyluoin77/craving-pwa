<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="utf-8">
<title>Just a Moment</title>

<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  background:black;
  color:white;
  font-family:system-ui,sans-serif;
  overflow:hidden;
}

#bg{
  position:fixed;
  inset:0;
  background-size:cover;
  background-position:center;
  opacity:0;
  transition:opacity 1.5s;
  z-index:0;
}

#overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.45);
  z-index:1;
}

#app{
  position:relative;
  z-index:2;
  max-width:420px;
  margin:auto;
  top:50%;
  transform:translateY(-50%);
  text-align:center;
  padding:24px;
}

.text{
  font-size:22px;
  line-height:1.5;
  margin-bottom:20px;
}

.timer{
  font-size:48px;
  margin-bottom:20px;
}

.buttons{
  display:flex;
  gap:10px;
}

button{
  flex:1;
  padding:14px;
  font-size:16px;
  border:none;
  border-radius:10px;
  background:#2563eb;
  color:white;
  cursor:pointer;
}

.secondary{background:#374151;}
</style>
</head>

<body>

<div id="bg"></div>
<div id="overlay"></div>
<div id="app"></div>

<audio id="audio" src="ambient_brown_ok.wav" loop></audio>

<script>
/* ===== ×ª××•× ×•×ª ===== */
const images=[
 "bg1.png","bg2.png","bg3.png","bg4.png","bg5.png",
 "bg6.png","bg7.png","bg8.png","bg9.png","bg10.png","bg11.png"
];

const bg=document.getElementById("bg");
let imgIndex=Math.floor(Math.random()*images.length);

function showImage(){
  bg.style.opacity=0;
  setTimeout(()=>{
    bg.style.backgroundImage=`url('${images[imgIndex]}')`;
    bg.style.opacity=1;
    imgIndex=Math.floor(Math.random()*images.length);
  },500);
}
showImage();
setInterval(showImage,15000);

/* ===== ××•×“×™×• ===== */
const audio=document.getElementById("audio");
audio.volume=0.28;
let muted=false;

/* ===== ×˜×§×¡×˜×™× ===== */
const heTexts=[
 "××™×Ÿ ×¦×•×¨×š ×œ××”×¨.",
 "×¢×•×“ ×¨×’×¢ ×©×œ ×©×§×˜.",
 "×”×“×—×£ ×™×“×¢ ×œ×”×™×¨×’×¢.",
 "××¤×©×¨ ×¤×©×•×˜ ×œ×”×™×•×ª ×›××Ÿ.",
 "×–×” ×™×¢×‘×•×¨ ×’× ×‘×œ×™ ×¤×¢×•×œ×”.",
 "×”×’×•×£ × ×¨×’×¢ ×œ××˜."
];

const enTexts=[
 "Just stay with the moment.",
 "You donâ€™t need to decide now.",
 "Let the urge rise and fall.",
 "Nothing is required of you.",
 "This feeling will pass.",
 "You are allowed to pause."
];

/* ğŸ”§ ××©×§×œ ×©×¤×•×ª */
const HEBREW_WEIGHT=0.7; // 70% ×¢×‘×¨×™×ª, 30% ×× ×’×œ×™×ª

let currentText="";
function randomText(){
  const useHebrew=Math.random()<HEBREW_WEIGHT;
  const arr=useHebrew?heTexts:enTexts;
  let next;
  do{
    next=arr[Math.floor(Math.random()*arr.length)];
  }while(next===currentText);
  currentText=next;
  return next;
}

/* ===== ×˜×™×™××¨ ===== */
let remaining=600;
let timer,textTimer;
let paused=false;

const app=document.getElementById("app");

function start(){
  audio.play().catch(()=>{});
  render(true);

  timer=setInterval(()=>{
    if(paused) return;
    remaining--;
    render(false);
    if(remaining<=0){
      clearInterval(timer);
      clearInterval(textTimer);
    }
  },1000);

  textTimer=setInterval(()=>{
    if(!paused) render(true);
  },8000);
}

function togglePause(){
  paused=!paused;
  render(false);
}

function toggleMute(){
  muted=!muted;
  audio.muted=muted;
  render(false);
}

function skipText(){
  render(true);
}

function render(changeText){
  const m=String(Math.floor(remaining/60)).padStart(2,"0");
  const s=String(remaining%60).padStart(2,"0");
  const text=changeText?randomText():currentText;

  app.innerHTML=`
    <div class="text">${text}</div>
    <div class="timer">${m}:${s}</div>
    <div class="buttons">
      <button class="secondary" onclick="skipText()">×“×œ×’</button>
      <button class="secondary" onclick="togglePause()">${paused?"â–¶ï¸ ×”××©×š":"â¸ï¸ ×”×©×”×”"}</button>
      <button class="secondary" onclick="toggleMute()">${muted?"ğŸ”Š ×¡××•× ×“":"ğŸ”‡ ×”×©×ª×§"}</button>
    </div>
  `;
}

/* ×”×§×©×” ×¢×œ ×”××¡×š = ×“×™×œ×•×’ */
document.addEventListener("click",e=>{
  if(e.target.tagName!=="BUTTON") skipText();
});

app.innerHTML=`
  <div class="text">×× ×‘× ×œ×š ×¡×™×’×¨×™×” â€” ×‘×•× × ×©×”×” ×¨×’×¢.</div>
  <button onclick="start()">×”×ª×—×œ</button>
`;
</script>

</body>
</html>
